# P207: Determine the greatest common divisor of two positive integer numbers

求最大公約數。

## 最大公因數

>最大公因數（英語：highest common factor，hcf）也稱最大公約數（英語：greatest common divisor，gcd）是數學詞𢑥，指能够整除多個整數的最大正整數。而多個整數不能都為零。例如8和12的最大公因數為4。
>整數序列$$a$$的最大公因數可以記為$$(a_1,a_2,...,a_n)$$或$$gcd(a_1,a_2,...,a_n)$$。
>求兩個整數最大公因數主要的方法：
>
> * 窮舉法：分別列出兩整數的所有因數，並找出最大公因數。
> * 質因數分解：分別列出兩數的質因數分解式，並計算共同項的乘積。
> * 短除法：兩數除以其共同質因數，直到兩數互質時，所有除數的乘積即為最大公因數。
> * 輾轉相除法：兩數相除，取餘數重複進行相除，直到餘數為0時，直到餘數為0時，前一個除數即為最大公因數。[^wiki-hcf]

照例先寫測試用例：

[include](../../../tests/arithmetic/p207_test.py)

「輾轉相除法」是一個簡單有效的求最大公約數的方法。

## 輾轉相除法

>在數學中，輾轉相除法，又稱歐幾里得算法（英語：Euclidean algorithm），是求最大公因數的算法。輾轉相除法首次出現於歐幾里得的《幾何原本》（第VII卷，命题i和ii）中，而在中國則可以追溯至東漢出現的《九章算術》。[^wiki-division]

### 計算過程

>輾轉相除法是一種遞迴算法，每一步計算的輸出值就是下一步計算時的輸入值。設k表示步驟數（從0開始計數），算法的計算過程如下。
>
>每一步的輸入是都是前兩次計算的非負餘數$$r_{k−1}$$和$$r_{k−2}$$。因為每一步計算出的餘數都在不斷減小，所以，$$r_{k−1}$$小於$$r_{k−2}$$。在第k步中，算法計算出滿足以下等式的商$$q_k$$和餘數$$r_k$$：

$$
r_{k-2} = q_kr_{k-1} + r_k
$$

>其中$$0 ≤ r_k < r_{k−1}$$。也就是$$r_{k−2}$$要不斷減去$$r_{k−1}$$直到比$$r_{k−1}$$小。
>
>為求簡明，以下只說明如何求兩個非負整數a和b的最大公約數（負數的情況是簡單的）。在第一步計算時（k = 0），設$$r_{−2}$$和$$r_{−1}$$分別等於a和b，第2步（此時k = 1）時計算$$r_{−1}$$（即b）和$$r_0$$（第一步計算產生的餘數）相除產生的商和餘數，以此類推。整個算法可以用如下等式表示： 

$$
\begin{align*}
a &= q_0b+r_0 \\
b &= q_1r_0+r_1 \\
r_0 &= q_2r_1+r_2 \\
r_1 &= q_3r_2+r_3 \\
...
\end{align*}
$$

>如果有$$a < b$$，算法的第一步實際上會把兩個數字交換，因為這時a除以b所得的商$$q_0$$會等於0，餘數$$r_0$$則等於a。然後，算法的第二步便是把b除以a，再計算所得之商和餘數。所以，對於$$k \geq 0$$總有$$r_k<r_{k−1}$$，即運算的每一步中得出的餘數一定小於上一步計算的餘數。
>由於每一步的餘數都在減小並且不為負數，必然存在第N步時$$r_N$$等於0，使算法終止，$$r_{N−1}$$就是a和b的最大公因數。其中N不可能無窮大，因為在$$r_0$$和0之間只有有限個自然數。[^wiki-division]

完整的代碼實現：

[include](../../../python99/arithmetic/p207.py)

輾轉相除法（`euclid(a,b)`）是一個遞歸算法。其接受兩個整數a和b，且a>b（所以需要在外層按大小排列好兩個整數），求出餘數`r0`和`r1`，`r0 = a % b, r1 = b % r0`。

* 若`r0`為0則`b`為最大公約數；
* 若`r1`為0則`r0`為最大公約數；
* 若`r0`和`r1`皆不為0則`r0, r1`的最大公約數即是`a, b`的最大公約數，問題被簡化為求`r0, r1`的最大公約數。

舉個例子，輸入整數36和63，求最大公約數：

1. 63大於36，以63為a以36為b，求得`r0`為27，`r1`為9。`r0`和`r1`皆不為0，所以求27和9的最大公約數。
2. 27為a，9為b，求得`r0`為0則b `9`為最大公約數。

$$
\begin{align*}
63 \mod 36 &= 27 \\
36 \mod 27 &= 9 \\
27 \mod 9 &= 0
\end{align*}
$$

## 參考文献

[^wiki-hcf]: https://zh.wikipedia.org/wiki/最大公因數
[^wiki-division]: https://zh.wikipedia.org/wiki/輾轉相除法
